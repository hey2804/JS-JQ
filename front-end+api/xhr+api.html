<!-- shift + alt + F : 快速整理對齊code -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API001</title>
</head>

<body>
    <div>
        <h2>用 XHR 串接 氣象局api</h2>
        <br>
        右鍵inspect，可以看到consle.log有印出資料。
    </div>
    <hr>
    <div>
        XHR 缺點：<br>
        一個AJAX的程式，並不是單純到只有對XHR的要求與回應這麼簡單，<br>
        例如你可能會對伺服器要求一份資料，當成功得到資料後，<br>
        後面還有需要進一步的資料處理流程，這樣就會涉及到異步程式的執行結構，<br>
        原生XHR並沒有提供可用的方式，它只是單純的作與伺服器互動這件事而已。<br>
        並且一個網站通常不只做一次request，假設要做很多次request，就要寫很長的一段request。
    </div>

    <script>
        // ㄧ個基礎的XMLHttpRequest物件如下

        function makeARequest() {
            // 建立一個新 XHR Object
            var xhr = new XMLHttpRequest();

            // 用.open() method 開始一個 request
            // 必須傳入兩個參數，第一個是 HTTP method (指定request傳送方式 get/post..)
            // 第二個是 request 要傳向的目的地 url (也就是你去要資料的 api url )
            xhr.open("GET", "https://opendata.cwb.gov.tw/api/v1/rest/datastore/W-C0033-001?Authorization=CWB-FD936122-D58A-4DE9-B2DE-B61469F2BD90", true);

            // 當 request 成功完成之後，會執行的 callback (即接收到的資料要用哪個function去處理)
            xhr.onload = function () {
                // Do something with the retrieved data 處理回傳資料
                console.log(xhr.responseText);
            };

            // 送出 request
            xhr.send();

        }
        makeARequest();
    </script>
</body>

</html>
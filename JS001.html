<!-- shift + alt + F : 快速整理對齊code -->

<!-- Request 有發出去的，瀏覽器也有收到 Response，
    重點是「瀏覽器因為同源政策，不把結果傳回給你的 JavaScript」 -->


<!-- 兩種解法: 

v1 : CORS規範 ( Cross-Origin HTTP request，跨來源 HTTP 請求)
規範內容:如果想開啟跨來源 HTTP 請求的話，
Server 必須在 Response 的 Header 裡面加上 Access-Control-Allow-Origin。
=> 要自己寫一個後端server

v2 : JSONP (JSON with Padding)
有些東西是不受同源政策限制的，例如說<script>這個 Tag，
我們不是常常引用 CDN 或是 Google Analytics 之類的第三方套件嗎？網址都是其他 Domain 的，但是卻能正常載入。
JSONP 就是利用<script>的這個特性來達成跨來源請求的。 
    
利用 JSONP 也可以存取跨來源的資料。
但 JSONP 的缺點就是你要帶的那些參數永遠都只能用附加在網址上的方式（GET）帶過去，沒辦法用 POST。
如果能用 CORS 的話，還是應該優先考慮 CORS。
-->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API001</title>
</head>

<body>
    <div id="weather">可以右鍵inspect，有傳送Request給中央氣象局的api，但因為同源政策而無法接收回傳的responseText。</div>

    <script>
        // ㄧ個基礎的XMLHttpRequest物件如下

        function makeARequest() {
            // 建立一個新 XHR Object
            var xhr = new XMLHttpRequest();

            // 用.open() method 開始一個 request
            // 必須傳入兩個參數，第一個是 HTTP method (指定request傳送方式 get/post..)
            // 第二個是 request 要傳向的目的地 url (也就是你去要資料的 api url )
            xhr.open("GET", "https://opendata.cwb.gov.tw/fileapi/v1/opendataapi/{O-A0001-001}?Authorization={CWB-FD936122-D58A-4DE9-B2DE-B61469F2BD90}&format={JSON}", true);

            // 當 request 成功完成之後，會執行的 callback (即接收到的資料要用哪個function去處理)
            xhr.onload = function () {
                // Do something with the retrieved data 處理回傳資料
                console.log(xhr.responseText);
            };

            // 送出 request
            xhr.send();

        }
        makeARequest();
    </script>
</body>

</html>
